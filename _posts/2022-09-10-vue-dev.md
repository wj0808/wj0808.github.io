---
layout: post
title: 从零开始搭建vue开发环境
tags: [devops,vue]
comments: true
---
从一台新服务器上，开始配置前端vue开发环境
<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<!-- **Table of Contents**  *generated with [DocToc](https://github.com/thlorenz/doctoc)* -->

- [1.选择一台服务器](#1%E9%80%89%E6%8B%A9%E4%B8%80%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8)
- [2.配置服务器环境](#2%E9%85%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%8E%AF%E5%A2%83)
  - [1.配置ssh](#1%E9%85%8D%E7%BD%AEssh)
  - [2.安装node](#2%E5%AE%89%E8%A3%85node)
- [3.远程开发](#3%E8%BF%9C%E7%A8%8B%E5%BC%80%E5%8F%91)
- [4.创建项目](#4%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE)
  - [1.采用vue-cli创建](#1%E9%87%87%E7%94%A8vue-cli%E5%88%9B%E5%BB%BA)
    - [1.eslint (vue-cli会自动给安装配置了)](#1eslint-vue-cli%E4%BC%9A%E8%87%AA%E5%8A%A8%E7%BB%99%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E4%BA%86)
  - [2.采用create-vue创建vite项目(更新)](#2%E9%87%87%E7%94%A8create-vue%E5%88%9B%E5%BB%BAvite%E9%A1%B9%E7%9B%AE%E6%9B%B4%E6%96%B0)
    - [1..editorconfig 兼容各系统](#1editorconfig-%E5%85%BC%E5%AE%B9%E5%90%84%E7%B3%BB%E7%BB%9F)
    - [2.prettierrc](#2prettierrc)
    - [3.eslint](#3eslint)
    - [4.git Husky和eslint](#4git-husky%E5%92%8Ceslint)
      - [1.pre-commit](#1pre-commit)
      - [2.commit-msg](#2commit-msg)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->


# 1.选择一台服务器
国内三大厂商：阿里云、腾讯云、华为云。
* 之前一直用阿里云，无奈阿里云太贵了；
* 然后换成了腾讯云，新用户会便宜很多，四百多买了一台4核8g系统盘180g的云服务器(linux)，性价比很高；
* 华为云之前买过windows的，不是新用户，也不便宜。

# 2.配置服务器环境
## 1.配置ssh
~~~
ssh-keygen -t rsa  # 后续参数可以全部不填（填了配置免密可能有问题），直接回车
cd ~/.ssh
ls # id_rsa  id_rsa.pub ,将id_rsa.pub放到github/gitlab，即可拉取提交代码
#配置免密，将本地id_rsa.pub文件内容复制
vim authorized_keys #粘贴之前复制的id_rsa.pub内容即可
# 也可以用命令配置免密 ssh-copy-id root@ip
~~~
## 2.安装node
[ubuntu安装node](https://github.com/nodesource/distributions)
执行如下脚本
~~~
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash - &&\
sudo apt-get install -y nodejs
node -v # v18.16.0
~~~

配置npm
~~~
npm config ls ## 查看简单的配置项
npm config ls -l  ##　查看所有配置项
npm config get cache  ## 查看缓存配置，get后面可以跟任意配置项
npm config edit  ## 直接编辑config文件，这个会打开文本

sudo npm config set prefix "/data/nodejs/node_global" #全局模式下，软件包安装地方
sudo npm config set cache "/data/nodejs/node_cache" #npm缓存目录
#设置环境变量path，全局模式下安装的包可以用命令执行
echo $PATH
sudo vim /etc/profile #在末尾添加export PATH="/data/nodejs/node_global/bin:$PATH"
#保存执行source
source /etc/profile

sudo npm config set registry https://registry.npm.taobao.org/ #将https://registry.npmjs.org/ 改为taobao镜像源，加快速度
~~~

# 3.远程开发
采用本地的vscode，通过ssh配置连接远程的linux服务器。
vscode 需要安装的插件
~~~
Vue Language Features (Volar) # 识别vue3
Prettier - Code formatter # 前端格式化代码插件
EditorConfig for VS Code # 兼容不同系统的编码风格
GitLens — Git supercharged # git变更可视化插件
~~~
vscode配置
~~~
//可以打开配置页面，用界面配置，一样的效果，其它都是默认的，下面是改动的项
//vscode的插件，点击设置可以快速进入要修改插件的地方，比如prettier
//ctrl+shift+p打开对应ssh的配置
{
    "editor.formatOnSave": true,
    "editor.codeActionsOnSave": {
        "source.fixAll.eslint": true
    },
    //参考.prettier.json的配置修改的
    "prettier.printWidth": 100,
    "prettier.semi": false,
    "prettier.singleQuote": true,
    "prettier.trailingComma": "none",
}
~~~

# 4.创建项目
## 1.采用vue-cli创建
~~~
npm install -g @vue/cli
vue create my-project
~~~
选择项如下所示：
![Crepe](../assets/img/2022-09-10-vue-dev/vue-cli-choose.png)
### 1.eslint (vue-cli会自动给安装配置了)
解决eslint和prettier冲突的问题：
~~~
npm i eslint-plugin-prettier eslint-config-prettier -D
~~~
.eslintrc.js中添加prettier插件：
~~~
 extends: [
    "plugin:vue/vue3-essential",
    "eslint:recommended",
    "@vue/typescript/recommended",
    "@vue/prettier",
    "@vue/prettier/@typescript-eslint",
    'plugin:prettier/recommended'
  ],
~~~


## 2.采用create-vue创建vite项目(更新)
npm create vue@3
按照 https://github.com/vuejs/create-vue 文档所示图的选择项(unit-test 和end-to-end test 选择的no，其它的跟文档选择一样) 配置即可

### 1..editorconfig 兼容各系统
~~~
# https://editorconfig.org

root = true

[*]
charset = utf-8
indent_style = space
indent_size = 2
end_of_line = lf
insert_final_newline = true
trim_trailing_whitespace = true

[*.md]
max_line_lenght=off
insert_final_newline = false
trim_trailing_whitespace = false
~~~
### 2.prettierrc
初始化已经安装好了，如果没安装，则npm install -D xxx
.prettierrc.json
~~~
{
  "$schema": "https://json.schemastore.org/prettierrc",
  "semi": false,
  "tabWidth": 2,
  "singleQuote": true,
  "printWidth": 100,
  "trailingComma": "none"
}
~~~
.prettierignore
~~~
node_modules
dist
*.local
vscode
~~~

package json里添加脚本"format": "prettier --write src/"

### 3.eslint
create-vue给自动配置好了

### 4.git Husky和eslint
husky是一个git hook工具，可以帮助我们触发git提交的各个阶段：pre-commit、commit-msg、pre-push
#### 1.pre-commit
这里我们可以使用自动配置命令：
~~~
npx husky-init && npm install #帮我们安装husky相关依赖，在项目目录下创建了.husky文件夹，在package.json中添加了脚本
~~~
修改 .husky下的 pre-commit 文件 npm test ->npm run lint
在进行git commit的时候，会自动对代码进行lint校验和fix
#### 2.commit-msg
但是如果每次手动来编写这些是比较麻烦的事情，我们可以使用一个工具：Commitizen,Commitizen 是一个帮助我们编写规范 commit message 的工具；
安装Commitizen
~~~
npm install commitizen -D 
~~~
安装cz-conventional-changelog，并且初始化cz-conventional-changelog：
~~~
npx commitizen init cz-conventional-changelog --save-dev --save-exact
~~~
这个命令会帮助我们安装cz-conventional-changelog，并在package.json中进行配置config

然后修改代码，git add . 再执行npx cz 可以弹出一步步操作,按提示提交即可,即可生成规范的git commit msg

npx cz，不能阻止git commit -m "xxx"不规范的操作
1. 我们可以通过commitlint来限制提交；
~~~
npm i @commitlint/config-conventional @commitlint/cli -D
~~~
2. 在根目录创建commitlint.config.ts文件，配置commitlint
~~~
module.exports = {
  extends: ['@commitlint/config-conventional']
}
~~~
3. 使用husky生成commit-msg文件，验证提交信息：
~~~
npx husky add .husky/commit-msg "npx --no-install commitlint --edit $1"
~~~
可以在package.json中配置脚本
~~~
 "commit": "cz"
~~~
以后可以通过npm run commit提交代码即可

# 5.第三方库封装